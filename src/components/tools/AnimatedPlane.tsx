"use client";

import { useEffect, useRef } from "react";
import gsap from "gsap";
import { MotionPathPlugin } from "gsap/MotionPathPlugin";

gsap.registerPlugin(MotionPathPlugin);

const FlyingPlane = () => {
  const planeRef = useRef<SVGSVGElement | null>(null);
  const trailRef = useRef<SVGPathElement | null>(null);

  useEffect(() => {
    if (!planeRef.current || !trailRef.current) return;

    // The flight path â€” enters from bottom-right, curves up to the left
    const path = "M 110vw,110vh C 80vw,70vh 60vw,55vh 20vw,20vh";

    // Animate the trail stroke being drawn
    const trailEl = trailRef.current;
    const length = trailEl.getTotalLength();
    gsap.set(trailEl, {
      strokeDasharray: length,
      strokeDashoffset: length,
    });

    const tl = gsap.timeline({ delay: 0.4 });

    // Draw the trail in sync with the plane
    tl.to(
      trailEl,
      {
        strokeDashoffset: 0,
        ease: "power2.inOut",
        duration: 2.2,
      },
      0
    );

    // Fly the plane along the path
    tl.to(
      planeRef.current,
      {
        motionPath: {
          path,
          align: "self",
          autoRotate: true,
          alignOrigin: [0.5, 0.5],
        },
        ease: "power2.inOut",
        duration: 2.2,
      },
      0
    );

    // Fade the trail out after the plane lands
    tl.to(trailEl, {
      opacity: 0,
      duration: 1,
      ease: "power1.in",
    });

    return () => {
      tl.kill();
    };
  }, []);

  return (
    <svg width="54" height="57" viewBox="0 0 54 57" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12.6021 10.4648L14.9371 12.3483L11.9485 17.6462L8.05674 14.507L12.6021 10.4648Z" fill="#898890"/>
<path d="M1 21.6626L6.44841 26.0575L12.099 19.0524L6.65055 14.6575L1 21.6626Z" fill="#C6C5CA"/>
<path d="M45.2925 36.834L47.6276 38.7176L44.6389 44.0155L40.7472 40.8763L45.2925 36.834Z" fill="#898890"/>
<path d="M33.6904 48.0319L39.1388 52.4267L44.7894 45.4216L39.341 41.0268L33.6904 48.0319Z" fill="#C6C5CA"/>
<path d="M27.5153 30.203L50.2636 43.4134L45.8687 48.8618L18.7256 41.0998L27.5153 30.203Z" fill="#64C1F7"/>
<path d="M43.5123 13.5568L52.8524 21.0908L49.7132 24.9826L37.8617 20.5619L43.5123 13.5568Z" fill="#64C1F7"/>
<path d="M24.4019 27.6916L6.67637 8.25446L2.2815 13.7029L15.6122 38.5885L24.4019 27.6916Z" fill="#64C1F7"/>
<path d="M38.0639 9.16191L28.7238 1.62784L25.5846 5.51956L32.4133 16.167L38.0639 9.16191Z" fill="#64C1F7"/>
<path d="M37.9134 7.75573L44.1401 12.7784L33.4411 32.4133L15.8616 54.207L8.20282 55.7378L3.53276 51.9708L3.40808 44.1615L20.9876 22.3679L37.9134 7.75573Z" fill="#E9E9EA"/>
<path d="M40.7258 7.45472L43.8391 9.96607L35.5267 18.6784L33.97 17.4227L40.7258 7.45472Z" fill="#64C1F7"/>
<path d="M12.7041 51.2836L15.5165 50.9826L15.3036 48.9942L12.9033 49.2512L8.87771 46.004L8.6208 43.6036L6.63245 43.8164L6.93346 46.6288C6.96164 46.8925 7.09342 47.1342 7.29979 47.3007L11.9699 51.0678C12.1763 51.2342 12.4404 51.3119 12.7041 51.2836Z" fill="#BDFDFF"/>
<path d="M1.40034 14.1741L3.14111 17.4155L0.221661 21.0348C0.0551477 21.2412 -0.0225428 21.5053 0.00568231 21.769C0.0339074 22.0328 0.165736 22.2745 0.372166 22.441L5.82057 26.8358C6.027 27.0024 6.29112 27.08 6.55483 27.0518C6.81854 27.0236 7.06024 26.8918 7.22675 26.6853L7.75414 26.0315L11.3441 32.7303L2.62973 43.5337C2.48268 43.7153 2.40385 43.9426 2.40694 44.1762L2.53162 51.9855C2.53337 52.1325 2.56778 52.2773 2.63234 52.4093C2.6969 52.5414 2.79001 52.6575 2.90492 52.7491L7.57498 56.5162C7.6889 56.6091 7.82205 56.6755 7.96479 56.7107C8.10753 56.7458 8.25629 56.7488 8.40033 56.7194L16.0591 55.1885C16.2881 55.1421 16.4936 55.0169 16.6399 54.8348L25.3543 44.0314L33.7032 46.4233L32.9121 47.404C32.7456 47.6104 32.6679 47.8746 32.6961 48.1383C32.7243 48.402 32.8562 48.6437 33.0626 48.8102L38.511 53.2051C38.7174 53.3716 38.9815 53.4493 39.2453 53.421C39.509 53.3928 39.7507 53.261 39.9172 53.0546L43.1003 49.1084L45.5947 49.8228C45.7834 49.8767 45.9839 49.8738 46.171 49.8146C46.3581 49.7554 46.5237 49.6424 46.6471 49.4897L51.0419 44.0413C51.132 43.9285 51.1969 43.7977 51.2322 43.6578C51.2675 43.5179 51.2724 43.372 51.2467 43.23C51.2056 42.9947 51.0791 42.7828 50.8914 42.6351C50.8534 42.6023 50.8122 42.5733 50.7684 42.5487L47.6366 40.7291L48.4986 39.2146C48.6164 39.0078 48.6567 38.7658 48.6121 38.5321C48.5675 38.2983 48.4411 38.0881 48.2554 37.9392L45.9204 36.0557C45.7356 35.9057 45.5034 35.8266 45.2655 35.8325C45.0275 35.8384 44.7996 35.929 44.6224 36.0879L42.6554 37.8417L34.2618 32.9726C34.2847 32.9478 34.3032 32.9194 34.3168 32.8885L40.0172 22.429L49.3658 25.9229C49.5628 25.9933 49.7767 26.001 49.9782 25.9451C50.1798 25.8891 50.3591 25.7722 50.4916 25.6104L53.6308 21.7187C53.7973 21.5123 53.875 21.2481 53.8467 20.9844C53.8185 20.7207 53.6867 20.479 53.4803 20.3125L44.934 13.4188L45.0159 13.2536C45.1274 13.0486 45.1636 12.811 45.1183 12.5821C45.073 12.3532 44.9491 12.1473 44.768 12.0001L43.9274 11.322L44.5672 10.6562C44.7548 10.4507 44.8535 10.1794 44.842 9.9014C44.8308 9.76332 44.7918 9.62893 44.7273 9.5063C44.6629 9.38367 44.5743 9.27531 44.467 9.18773L41.3536 6.67637C41.2453 6.59 41.1206 6.52639 40.9871 6.48935C40.8536 6.45232 40.714 6.44262 40.5767 6.46084C40.3026 6.50842 40.0584 6.66236 39.8972 6.88915L39.3818 7.65545L38.5412 6.97738C38.3591 6.83153 38.1316 6.75399 37.8983 6.75818C37.665 6.76238 37.4404 6.84804 37.2636 7.00034L37.1195 7.11533L28.5733 0.221661C28.3668 0.0551477 28.1027 -0.0225428 27.839 0.00568231C27.5753 0.0339074 27.3336 0.165736 27.1671 0.372166L24.0279 4.26388C23.8978 4.42763 23.8215 4.62761 23.8095 4.83642C23.7974 5.04522 23.8503 5.25264 23.9607 5.43024L29.3539 13.8277L20.3378 21.6125C20.3105 21.6324 20.2867 21.6565 20.2672 21.6841L14.4334 15.2824L15.8082 12.8454C15.926 12.6386 15.9663 12.3966 15.9217 12.1628C15.8771 11.9291 15.7506 11.7189 15.565 11.57L13.23 9.68647C13.0465 9.53713 12.8161 9.45764 12.5796 9.46212C12.3432 9.4666 12.1159 9.55476 11.9383 9.71093L10.5167 10.9796L7.41469 7.57808C7.38134 7.54051 7.34433 7.50636 7.30421 7.47612C7.1201 7.32395 6.88627 7.24514 6.64761 7.25483C6.50337 7.25971 6.36184 7.29541 6.23255 7.35954C6.10326 7.42367 5.9892 7.51474 5.89803 7.62662L1.50316 13.075C1.38004 13.2279 1.30465 13.4136 1.28636 13.6091C1.26808 13.8045 1.30772 14.001 1.40034 14.1741ZM38.9883 51.0205L35.0966 47.8814L35.7935 47.0174L41.01 48.5143L38.9883 51.0205ZM45.3263 38.146L46.3381 38.9622L45.9087 39.7336L44.4752 38.8985L45.3263 38.146ZM33.0014 34.5512L48.7507 43.6963L45.5048 47.7203L26.7167 42.3424L33.0014 34.5512ZM51.4462 21.2414L49.3869 23.7943L40.9802 20.6619L43.9586 15.2015L51.4462 21.2414ZM42.3629 10.0601L35.4385 17.3224L35.3139 17.2219L40.9463 8.91741L42.3629 10.0601ZM26.0366 4.95915L28.0959 2.40619L35.5836 8.446L30.8773 12.5126L26.0366 4.95915ZM21.7094 23.0658L37.9316 9.05518L38.2585 9.31887L33.1415 16.8571C33.0018 17.0659 32.9449 17.3194 32.982 17.5679C33.0192 17.8164 33.1476 18.0421 33.3422 18.201L34.8989 19.4567C35.0954 19.6133 35.3432 19.691 35.5939 19.6747C35.8446 19.6584 36.0803 19.5492 36.2548 19.3685L42.5394 12.772L42.8663 13.0357L32.6062 31.8556L15.3092 53.2989L8.46484 54.6644L4.52642 51.4875L4.41244 44.5092L21.7094 23.0658ZM6.2979 24.6513L2.40619 21.5121L4.16413 19.3328L6.72483 24.122L6.2979 24.6513ZM12.6359 11.7768L13.6477 12.593L13.0153 13.7274L11.8554 12.4577L12.6359 11.7768ZM6.72015 9.79296L18.9912 23.2501L12.7065 31.0413L3.47422 13.817L6.72015 9.79296Z" fill="black"/>
<path d="M12.7041 51.2836L15.5165 50.9826L15.3036 48.9942L12.9033 49.2512L8.87771 46.004L8.6208 43.6036L6.63245 43.8164L6.93346 46.6288C6.96164 46.8925 7.09342 47.1342 7.29979 47.3007L11.9699 51.0678C12.1763 51.2342 12.4404 51.3119 12.7041 51.2836Z" fill="black"/>
</svg>

  );
};

export default FlyingPlane;